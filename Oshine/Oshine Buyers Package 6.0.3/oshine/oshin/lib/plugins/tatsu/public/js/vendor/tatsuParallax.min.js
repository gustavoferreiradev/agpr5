!function(a){"use strict";var t;a.fn.tatsuParallax=function(e){var n={speed:.4};t=a(this),e=a.extend(n,e);var r=window.innerHeight,s=function(){var n,s,i,o,d=a(window).scrollTop();t.each(function(){if((n=a(this)).hasClass("tatsu-parallaxed")){if(o=n.data("speed")||e.speed,s=n.offset().top,i=n.outerHeight(!0),s+i<d||s>d+r)return;var t=s-r>0?s-r:0;n.find(".tatsu-parallax-element-wrap").css({transform:"translate3d( 0,"+Math.round((d-t)*-o)+"px, 0)"})}})},i=function(e,n){if(e)s=a(".tatsu-parallaxed").find(".tatsu-parallax-element-wrap");else var s=t.find(".tatsu-parallax-element-wrap");s.each(function(){var t,e,s=a(this),i=s.parent(),o=i.outerHeight(),d=s.parent().offset().top,l=document.body.scrollHeight;i.data("speed")&&!n?e=i.data("speed"):(e=n,i.data({speed:n})),l>d+o+r?(t=Math.round((o+r)*e)+o,d<r&&(t=o+Math.round((o+d)*e))):t=s.parent().innerHeight()+Math.round((l-d)*e),s.height(t)})};return a(window).on("resize",function(){r=window.innerHeight,i(!0),s()}),a(window).on("scroll",function(){requestAnimationFrame(function(){s()})}),t.each(function(){a(this).hasClass("tatsu-parallaxed")||a(this).addClass("tatsu-parallaxed")}),i(!1,e.speed),this}}(jQuery);